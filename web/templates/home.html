<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Durin's Door — Encrypted File Sharing</title>
  <link rel="stylesheet" href="/static/style.css">
  <style>
    .speak-friend {
      font-family: 'IM Fell English', Georgia, serif;
      font-style: italic;
      color: var(--elvish);
      text-align: center;
      font-size: clamp(0.88rem, 2.2vw, 1.05rem);
      margin-bottom: 2.5rem;
      letter-spacing: 0.06em;
      text-shadow: 0 0 12px rgba(107,197,255,0.6), 0 0 35px rgba(107,197,255,0.25);
      animation: speakPulse 4.5s ease-in-out infinite;
    }
    @keyframes speakPulse {
      0%,100% { opacity:0.65; text-shadow: 0 0 10px rgba(107,197,255,0.45); }
      50%      { opacity:1;    text-shadow: 0 0 22px rgba(107,197,255,0.85), 0 0 55px rgba(107,197,255,0.35); }
    }
    .cmd-hint {
      color: var(--elvish);
      background: var(--bg-stone);
      padding: 0.25rem 0.75rem;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 0.82rem;
      border: 1px solid rgba(107,197,255,0.18);
      display: inline-block;
    }
    .flavor-text {
      text-align: center;
      color: var(--text-dim);
      font-size: 0.83rem;
      max-width: 380px;
      margin: 1.4rem auto 0;
      line-height: 1.9;
      font-style: italic;
    }
    /* Mountain silhouette fixed at bottom */
    .mountain-silhouette {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      pointer-events: none;
      z-index: 1;
      height: 130px;
    }
    /* Extra stone-crack shimmer for door */
    @keyframes crackPulse {
      0%,100% { opacity: 0.18; }
      50%      { opacity: 0.50; }
    }
    @keyframes glowPulse {
      0%,100% { opacity: 0.35; }
      50%      { opacity: 0.70; }
    }
    @keyframes starRotate {
      from { transform: rotate(0deg); }
      to   { transform: rotate(360deg); }
    }
    .rune-spin {
      transform-origin: 200px 200px;
      animation: starRotate 60s linear infinite;
    }
  </style>
</head>
<body>

  <!-- Twinkling star field -->
  <canvas id="stars-canvas"></canvas>

  <!-- Mountain silhouette -->
  <svg class="mountain-silhouette" viewBox="0 0 1400 130" preserveAspectRatio="none"
       xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <defs>
      <linearGradient id="mountFade" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#0a0e1a" stop-opacity="0"/>
        <stop offset="55%" stop-color="#080c16" stop-opacity="0.7"/>
        <stop offset="100%" stop-color="#050810" stop-opacity="1"/>
      </linearGradient>
    </defs>
    <path d="M0 130 L0 90 L60 55 L110 75 L170 32 L230 62 L290 20 L360 58
             L430 35 L500 70 L570 15 L640 55 L700 30 L760 65 L830 10
             L890 50 L950 25 L1020 60 L1080 38 L1140 70 L1200 22 L1260 55
             L1320 40 L1380 68 L1400 50 L1400 130 Z"
          fill="#07090f"/>
    <!-- Snow caps -->
    <path d="M170 32 L185 45 L155 45 Z M290 20 L305 36 L275 36 Z M570 15 L586 32 L554 32 Z
             M700 30 L714 44 L686 44 Z M830 10 L847 28 L813 28 Z M950 25 L965 40 L935 40 Z
             M1200 22 L1215 37 L1185 37 Z"
          fill="#1a2540" opacity="0.5"/>
    <rect x="0" y="0" width="1400" height="130" fill="url(#mountFade)"/>
  </svg>

  <!-- Mist -->
  <div class="mist-layer"></div>

  <!-- Page -->
  <div class="page-wrapper">

    <!-- ══ The Door ══════════════════════════════════ -->
    <div class="door-container fade-in-up" id="doorWrap">
      <svg class="door-svg" viewBox="0 0 400 520"
           xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Durin's Door arch">
        <defs>
          <!-- Glow filters -->
          <filter id="glow-elvish" x="-100%" y="-100%" width="300%" height="300%">
            <feGaussianBlur stdDeviation="3.5" result="b"/>
            <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
          <filter id="glow-silver" x="-80%" y="-80%" width="260%" height="260%">
            <feGaussianBlur stdDeviation="2.5" result="b"/>
            <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
          <filter id="glow-gold" x="-100%" y="-100%" width="300%" height="300%">
            <feGaussianBlur stdDeviation="5" result="b"/>
            <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
          <filter id="glow-crack" x="-200%" y="-50%" width="500%" height="200%">
            <feGaussianBlur stdDeviation="4" result="b"/>
            <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>

          <!-- Door void gradient -->
          <radialGradient id="voidGrad" cx="50%" cy="25%" r="70%">
            <stop offset="0%" stop-color="#0c1424"/>
            <stop offset="60%" stop-color="#060910"/>
            <stop offset="100%" stop-color="#020408"/>
          </radialGradient>

          <!-- Door crack glow at base -->
          <radialGradient id="crackGrad" cx="50%" cy="100%" r="60%">
            <stop offset="0%" stop-color="rgba(107,197,255,0.45)"/>
            <stop offset="100%" stop-color="rgba(107,197,255,0)"/>
          </radialGradient>

          <!-- Subtle stone texture -->
          <pattern id="stoneTex" x="0" y="0" width="60" height="44" patternUnits="userSpaceOnUse">
            <rect width="60" height="44" fill="#0d1525"/>
            <line x1="0" y1="0"  x2="60" y2="0"  stroke="#111e34" stroke-width="0.7"/>
            <line x1="0" y1="22" x2="60" y2="22" stroke="#111e34" stroke-width="0.7"/>
            <line x1="30" y1="0" x2="30" y2="22" stroke="#111e34" stroke-width="0.4"/>
            <line x1="0"  y1="22" x2="0"  y2="44" stroke="#111e34" stroke-width="0.4"/>
            <line x1="60" y1="22" x2="60" y2="44" stroke="#111e34" stroke-width="0.4"/>
          </pattern>

          <!-- Slow-rotating ring clip -->
          <clipPath id="archClip">
            <rect x="0" y="0" width="400" height="520"/>
          </clipPath>
        </defs>

        <!-- ── Stone wall (compound path with arch hole) ── -->
        <path fill="url(#stoneTex)" stroke="#1a2844" stroke-width="0.6"
              fill-rule="evenodd"
              d="M 0 0 L 400 0 L 400 520 L 0 520 Z
                 M 88 512 L 88 308 Q 86 105 200 68 Q 314 105 312 308 L 312 512 Z"/>

        <!-- ── Door void / opening ── -->
        <path fill="url(#voidGrad)"
              d="M 88 512 L 88 308 Q 86 105 200 68 Q 314 105 312 308 L 312 512 Z"/>

        <!-- Glow pool at door base (crack of light) -->
        <ellipse cx="200" cy="512" rx="90" ry="16" fill="url(#crackGrad)">
          <animate attributeName="opacity" values="0.5;1.0;0.5" dur="3.2s" repeatCount="indefinite"/>
        </ellipse>

        <!-- ── Arch outlines ── -->
        <!-- Outermost faint stone edge -->
        <path fill="none" stroke="#2e4268" stroke-width="1.2" opacity="0.45"
              d="M 65 512 L 65 305 Q 62 90 200 48 Q 338 90 335 305 L 335 512"/>
        <!-- Main outer arch (CSS class) -->
        <path class="arch-outer"
              d="M 88 512 L 88 308 Q 86 105 200 68 Q 314 105 312 308 L 312 512"/>
        <!-- Inner arch line (CSS class) -->
        <path class="arch-inner"
              d="M 106 512 L 106 312 Q 106 122 200 87 Q 294 122 294 312 L 294 512"/>

        <!-- Stone-cut edge highlight (reflected light at arch top) -->
        <path fill="none" stroke="rgba(120,160,220,0.12)" stroke-width="4"
              d="M 88 310 Q 86 108 200 68 Q 314 108 312 310"/>

        <!-- ── Rune inscription band (arch top) ── -->
        <!-- Outer band -->
        <path fill="rgba(42,58,92,0.25)" stroke="rgba(42,58,92,0.4)" stroke-width="0.5"
              d="M 65 305 Q 62 90 200 48 Q 338 90 335 305 L 345 305 Q 345 80 200 36 Q 55 80 55 305 Z"/>

        <!-- Inscription text (top of arch) -->
        <text class="rune-text" x="200" y="52" text-anchor="middle"
              font-size="12" letter-spacing="5">ᛗᛖᛚᛚᛟᚾ · ᚠᚱᛖᛟᚾᛞ · ᛖᚾᛏᛖᚱ</text>

        <!-- Slow-rotating outer rune ring -->
        <g class="rune-spin" clip-path="url(#archClip)">
          <circle cx="200" cy="200" r="148"
                  fill="none" stroke="rgba(107,197,255,0.06)" stroke-width="0.8"
                  stroke-dasharray="4 8"/>
        </g>

        <!-- ── Star of Durin (center of arch) ── -->
        <g filter="url(#glow-silver)">
          <g class="star-of-durin" transform="translate(200,196)">
            <!-- 8 cardinal rays -->
            <line x1="0" y1="-46" x2="0"   y2="46"  stroke-width="1.5"/>
            <line x1="-46" y1="0" x2="46"  y2="0"   stroke-width="1.5"/>
            <line x1="-33" y1="-33" x2="33" y2="33" stroke-width="1.4"/>
            <line x1="33"  y1="-33" x2="-33" y2="33" stroke-width="1.4"/>
            <!-- Outer ring -->
            <polygon points="0,-54 38,-38 54,0 38,38 0,54 -38,38 -54,0 -38,-38"
                     fill="none" stroke="var(--silver)" stroke-width="0.7" opacity="0.45"/>
            <!-- Mid ring -->
            <circle r="30" fill="none" stroke="var(--silver)" stroke-width="0.5" opacity="0.3"/>
            <!-- Small gem circle -->
            <circle r="10" fill="none" stroke-width="1.2"/>
            <!-- Center gem -->
            <circle r="4" fill="var(--silver-glow)" stroke="none"/>
          </g>
        </g>

        <!-- ── Elvish tree (below star) ── -->
        <g filter="url(#glow-elvish)" opacity="0.80">
          <!-- Trunk -->
          <line x1="200" y1="278" x2="200" y2="335"
                stroke="var(--elvish)" stroke-width="1.6"/>
          <!-- Root spread -->
          <line x1="200" y1="335" x2="182" y2="346"
                stroke="var(--elvish)" stroke-width="1"/>
          <line x1="200" y1="335" x2="218" y2="346"
                stroke="var(--elvish)" stroke-width="1"/>
          <!-- Left branches -->
          <line x1="200" y1="325" x2="176" y2="312"
                stroke="var(--elvish)" stroke-width="1.0"/>
          <line x1="200" y1="313" x2="170" y2="296"
                stroke="var(--elvish)" stroke-width="0.8"/>
          <line x1="200" y1="303" x2="178" y2="284"
                stroke="var(--elvish)" stroke-width="0.7"/>
          <!-- Right branches -->
          <line x1="200" y1="325" x2="224" y2="312"
                stroke="var(--elvish)" stroke-width="1.0"/>
          <line x1="200" y1="313" x2="230" y2="296"
                stroke="var(--elvish)" stroke-width="0.8"/>
          <line x1="200" y1="303" x2="222" y2="284"
                stroke="var(--elvish)" stroke-width="0.7"/>
          <!-- Leaf buds (dots) -->
          <circle cx="174" cy="310" r="2.8" fill="var(--elvish)" opacity="0.75"/>
          <circle cx="168" cy="293" r="2.2" fill="var(--elvish)" opacity="0.65"/>
          <circle cx="176" cy="281" r="2.0" fill="var(--elvish)" opacity="0.60"/>
          <circle cx="226" cy="310" r="2.8" fill="var(--elvish)" opacity="0.75"/>
          <circle cx="232" cy="293" r="2.2" fill="var(--elvish)" opacity="0.65"/>
          <circle cx="224" cy="281" r="2.0" fill="var(--elvish)" opacity="0.60"/>
          <!-- Top blossom -->
          <circle cx="200" cy="255" r="2.5" fill="var(--elvish)" opacity="0.55"/>
          <circle cx="200" cy="278" r="1.5" fill="var(--elvish)" opacity="0.45"/>
        </g>

        <!-- ── Pillar rune strips ── -->
        <rect fill="rgba(30,44,72,0.35)" stroke="rgba(42,58,92,0.3)" stroke-width="0.5"
              x="65" y="112" width="23" height="195" rx="2"/>
        <rect fill="rgba(30,44,72,0.35)" stroke="rgba(42,58,92,0.3)" stroke-width="0.5"
              x="312" y="112" width="23" height="195" rx="2"/>

        <!-- Left pillar runes -->
        <text class="rune-text" x="76.5" y="140" text-anchor="middle" font-size="11" style="animation-delay:0.1s">ᚠ</text>
        <text class="rune-text" x="76.5" y="161" text-anchor="middle" font-size="11" style="animation-delay:0.5s">ᚢ</text>
        <text class="rune-text" x="76.5" y="182" text-anchor="middle" font-size="11" style="animation-delay:0.9s">ᚱ</text>
        <text class="rune-text" x="76.5" y="203" text-anchor="middle" font-size="11" style="animation-delay:1.3s">ᚨ</text>
        <text class="rune-text" x="76.5" y="224" text-anchor="middle" font-size="11" style="animation-delay:1.7s">ᛊ</text>
        <text class="rune-text" x="76.5" y="245" text-anchor="middle" font-size="11" style="animation-delay:2.1s">ᛏ</text>
        <text class="rune-text" x="76.5" y="266" text-anchor="middle" font-size="11" style="animation-delay:2.5s">ᛁ</text>
        <text class="rune-text" x="76.5" y="287" text-anchor="middle" font-size="11" style="animation-delay:2.9s">ᛜ</text>

        <!-- Right pillar runes -->
        <text class="rune-text" x="323.5" y="140" text-anchor="middle" font-size="11" style="animation-delay:0.3s">ᛞ</text>
        <text class="rune-text" x="323.5" y="161" text-anchor="middle" font-size="11" style="animation-delay:0.7s">ᚢ</text>
        <text class="rune-text" x="323.5" y="182" text-anchor="middle" font-size="11" style="animation-delay:1.1s">ᚱ</text>
        <text class="rune-text" x="323.5" y="203" text-anchor="middle" font-size="11" style="animation-delay:1.5s">ᛁ</text>
        <text class="rune-text" x="323.5" y="224" text-anchor="middle" font-size="11" style="animation-delay:1.9s">ᚾ</text>
        <text class="rune-text" x="323.5" y="245" text-anchor="middle" font-size="11" style="animation-delay:2.3s">ᛊ</text>
        <text class="rune-text" x="323.5" y="266" text-anchor="middle" font-size="11" style="animation-delay:2.7s">ᛟ</text>
        <text class="rune-text" x="323.5" y="287" text-anchor="middle" font-size="11" style="animation-delay:3.1s">ᛗ</text>

        <!-- Animated rune lines on pillars -->
        <line class="rune-line" x1="76.5" y1="305" x2="76.5" y2="118" style="animation-delay:0.2s"/>
        <line class="rune-line" x1="323.5" y1="305" x2="323.5" y2="118" style="animation-delay:0.7s"/>

        <!-- ── Central door crack (glowing) ── -->
        <line x1="200" y1="90" x2="200" y2="512"
              stroke="var(--elvish)" stroke-width="0.6" filter="url(#glow-crack)">
          <animate attributeName="opacity" values="0.10;0.38;0.10" dur="4.5s" repeatCount="indefinite"/>
        </line>

        <!-- Crown jewel at arch peak -->
        <circle cx="200" cy="68" r="5" fill="none"
                stroke="var(--gold)" stroke-width="1.2"
                filter="url(#glow-gold)" opacity="0.8"/>
        <circle cx="200" cy="68" r="9" fill="none"
                stroke="var(--gold-dim)" stroke-width="0.5" opacity="0.45"/>
        <circle cx="200" cy="68" r="2.5" fill="var(--gold)" filter="url(#glow-gold)" opacity="0.9"/>

        <!-- Stone threshold at base -->
        <rect x="55" y="508" width="290" height="9" rx="2"
              fill="#0d1525" stroke="#1e2d48" stroke-width="0.8"/>
        <line x1="55" y1="512" x2="345" y2="512"
              stroke="#2a3a5c" stroke-width="0.6" opacity="0.5"/>

        <!-- Corner carved knot work (top left / right of frame) -->
        <circle cx="86" cy="110" r="8" fill="none"
                stroke="rgba(107,197,255,0.18)" stroke-width="0.8"/>
        <circle cx="314" cy="110" r="8" fill="none"
                stroke="rgba(107,197,255,0.18)" stroke-width="0.8"/>

      </svg>
      <div class="door-glow" id="doorGlow"></div>
    </div>
    <!-- /.door-container -->

    <!-- Title -->
    <h1 class="site-title fade-in-up fade-in-up-delay-1">Durin's Door</h1>

    <!-- Elvish subtitle -->
    <p class="site-subtitle fade-in-up fade-in-up-delay-2">
      Encrypted. Temporary. Forgotten when the time comes.
    </p>

    <!-- Speak friend inscription -->
    <p class="speak-friend fade-in-up fade-in-up-delay-2">
      ✦ &thinsp; Speak, friend, and enter — then download. &thinsp; ✦
    </p>

    <!-- Stone tablets with stats -->
    <div class="stone-tablets fade-in-up fade-in-up-delay-3">
      <div class="stone-tablet">
        <span class="tablet-value">{{.ActiveShares}}</span>
        <span class="tablet-label">Open Portals</span>
      </div>
      <div class="stone-tablet">
        <span class="tablet-value" style="font-size:1.4rem; letter-spacing:-0.03em">AES</span>
        <span class="tablet-label">256&#8209;GCM</span>
      </div>
      <div class="stone-tablet">
        <span class="tablet-value" style="font-size:1.6rem">⏳</span>
        <span class="tablet-label">Self&#8209;Destruct</span>
      </div>
    </div>

    <!-- Usage hint -->
    <div class="fade-in-up fade-in-up-delay-4" style="text-align:center; margin-top:2rem;">
      <p style="margin-bottom:0.7rem;">
        <code class="cmd-hint">durins-door share myfile.zip</code>
      </p>
      <p class="flavor-text">
        Files encrypted before they touch the disk.<br>
        Links expire. The door closes. None shall pass.<br>
        No accounts. No logs. Only the Word of a friend.
      </p>
    </div>

  </div><!-- /.page-wrapper -->

  <script>
  /* ── Star field ──────────────────────────────────── */
  (function () {
    const cv = document.getElementById('stars-canvas');
    const cx = cv.getContext('2d');
    let W, H, stars = [], frame = 0;

    function resize() {
      W = cv.width  = window.innerWidth;
      H = cv.height = window.innerHeight;
      initStars();
    }

    function initStars() {
      stars = [];
      const N = Math.min(Math.floor(W * H / 4200) + 60, 320);
      for (let i = 0; i < N; i++) {
        stars.push({
          x:     Math.random() * W,
          y:     Math.random() * H * 0.74,
          r:     Math.random() * 1.45 + 0.18,
          phase: Math.random() * Math.PI * 2,
          speed: 0.003 + Math.random() * 0.018,
          blue:  Math.random() < 0.22,
        });
      }
    }

    function draw() {
      cx.clearRect(0, 0, W, H);
      frame++;
      for (const s of stars) {
        const lum = 0.30 + 0.70 * (0.5 + 0.5 * Math.sin(s.phase + frame * s.speed));
        cx.fillStyle = s.blue
          ? `rgba(155,215,255,${lum})`
          : `rgba(218,208,186,${lum * 0.88})`;
        cx.beginPath();
        cx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
        cx.fill();
      }
      requestAnimationFrame(draw);
    }

    window.addEventListener('resize', resize, { passive: true });
    resize();
    draw();
  })();

  /* ── Door hover glow ─────────────────────────────── */
  (function () {
    const wrap = document.getElementById('doorWrap');
    if (!wrap) return;
    wrap.addEventListener('mouseenter', () => wrap.classList.add('active'));
    wrap.addEventListener('mouseleave', () => wrap.classList.remove('active'));
  })();
  </script>
</body>
</html>
