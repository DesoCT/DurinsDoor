<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Durin's Door â€” Encrypted File Sharing</title>
  <link rel="stylesheet" href="/static/style.css">
  <style>
    .speak-friend {
      font-family: 'IM Fell English', Georgia, serif;
      font-style: italic;
      color: var(--elvish);
      text-align: center;
      font-size: clamp(0.88rem, 2.2vw, 1.05rem);
      margin-bottom: 2.5rem;
      letter-spacing: 0.06em;
      text-shadow: 0 0 12px rgba(107,197,255,0.6), 0 0 35px rgba(107,197,255,0.25);
      animation: speakPulse 4.5s ease-in-out infinite;
    }
    @keyframes speakPulse {
      0%,100% { opacity:0.65; text-shadow: 0 0 10px rgba(107,197,255,0.45); }
      50%      { opacity:1;    text-shadow: 0 0 22px rgba(107,197,255,0.85), 0 0 55px rgba(107,197,255,0.35); }
    }
    .cmd-hint {
      color: var(--elvish);
      background: var(--bg-stone);
      padding: 0.25rem 0.75rem;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 0.82rem;
      border: 1px solid rgba(107,197,255,0.18);
      display: inline-block;
    }
    .flavor-text {
      text-align: center;
      color: var(--text-dim);
      font-size: 0.83rem;
      max-width: 380px;
      margin: 1.4rem auto 0;
      line-height: 1.9;
      font-style: italic;
    }
    /* Mountain silhouette fixed at bottom */
    .mountain-silhouette {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      pointer-events: none;
      z-index: 1;
      height: 130px;
    }
    @keyframes crackPulse {
      0%,100% { opacity: 0.18; }
      50%      { opacity: 0.50; }
    }
    @keyframes glowPulse {
      0%,100% { opacity: 0.35; }
      50%      { opacity: 0.70; }
    }
    @keyframes starRotate {
      from { transform: rotate(0deg); }
      to   { transform: rotate(360deg); }
    }
    .rune-spin {
      transform-origin: 200px 200px;
      animation: starRotate 60s linear infinite;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HALL NAVIGATION LINKS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .hall-nav {
      display: flex;
      gap: 2.5rem;
      justify-content: center;
      align-items: center;
      margin-top: 2.8rem;
      flex-wrap: wrap;
    }
    .hall-link {
      color: var(--text-dim);
      text-decoration: none;
      font-family: 'Cinzel', serif;
      font-size: 0.78rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      padding: 0.5rem 1.2rem;
      border: 1px solid rgba(42,58,92,0.5);
      border-radius: 4px;
      background: rgba(17,24,39,0.6);
      transition: all 0.35s ease;
      position: relative;
      overflow: hidden;
    }
    .hall-link::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg,
        rgba(107,197,255,0) 0%,
        rgba(107,197,255,0.07) 100%);
      opacity: 0;
      transition: opacity 0.35s ease;
    }
    .hall-link:hover {
      color: var(--silver-glow);
      border-color: var(--border-rune);
      box-shadow: 0 0 14px rgba(107,197,255,0.12), inset 0 1px 0 rgba(255,255,255,0.04);
      transform: translateY(-1px);
    }
    .hall-link:hover::before { opacity: 1; }
    .hall-link-rune {
      margin-right: 0.4em;
      opacity: 0.6;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       EASTER EGG â€” PORTAL OVERLAY (Mellon)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #portal-overlay {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
      z-index: 10;
      border-radius: 50% 50% 0 0;
      opacity: 0;
      transition: opacity 0.8s ease;
      background: radial-gradient(ellipse 70% 60% at 50% 40%,
        rgba(150,220,255,0.55) 0%,
        rgba(80,180,255,0.30) 35%,
        rgba(20,60,120,0.10) 70%,
        transparent 100%);
    }
    #portal-overlay.open {
      opacity: 1;
    }
    #portal-stars {
      position: absolute;
      inset: 0;
      pointer-events: none;
    }
    .portal-star {
      position: absolute;
      width: 2px; height: 2px;
      background: #fff;
      border-radius: 50%;
      box-shadow: 0 0 4px 2px rgba(150,220,255,0.9);
      opacity: 0;
      animation: portalStarFade 2s ease-in-out infinite;
    }
    @keyframes portalStarFade {
      0%   { opacity: 0; transform: scale(0.5); }
      50%  { opacity: 1; transform: scale(1.2); }
      100% { opacity: 0; transform: scale(0.8); }
    }
    /* Message that appears below the door */
    #mellon-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, 160px);
      z-index: 200;
      text-align: center;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.8s ease 0.6s;
    }
    #mellon-message.show {
      opacity: 1;
    }
    .mellon-msg-text {
      font-family: 'IM Fell English', Georgia, serif;
      font-style: italic;
      font-size: clamp(1rem, 2.5vw, 1.3rem);
      color: #b8eaff;
      text-shadow: 0 0 20px rgba(107,197,255,0.9), 0 0 40px rgba(107,197,255,0.5);
      line-height: 1.7;
      margin-bottom: 1rem;
    }
    .gandalf-silhouette {
      font-size: 3.5rem;
      opacity: 0.35;
      display: block;
      margin-top: 0.5rem;
      filter: drop-shadow(0 0 12px rgba(107,197,255,0.6));
    }
    /* Rune hover highlight */
    .rune-hit:hover ~ .rune-hit-glow,
    .rune-hit.seq-active {
      fill: rgba(107,197,255,0.2);
    }
    .rune-hit-glow {
      fill: transparent;
      transition: fill 0.2s;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       EASTER EGG â€” BALROG OVERLAY (Konami)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #balrog-overlay {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      background: radial-gradient(ellipse at center bottom,
        rgba(220,60,0,0.95) 0%,
        rgba(150,20,0,0.88) 40%,
        rgba(60,5,0,0.97) 100%);
      animation: balrogFlash 0.15s ease;
    }
    #balrog-overlay.active {
      display: flex;
    }
    @keyframes balrogFlash {
      0%   { opacity: 0; }
      30%  { opacity: 1; }
      100% { opacity: 1; }
    }
    #balrog-overlay.fade-out {
      animation: balrogFadeOut 1.2s ease forwards;
    }
    @keyframes balrogFadeOut {
      0%   { opacity: 1; }
      100% { opacity: 0; }
    }
    .balrog-text {
      font-family: 'Cinzel Decorative', 'Cinzel', serif;
      font-size: clamp(2rem, 8vw, 5rem);
      font-weight: 700;
      color: #fff;
      text-shadow:
        0 0 20px rgba(255,150,0,1),
        0 0 50px rgba(255,80,0,0.8),
        0 0 100px rgba(255,40,0,0.5);
      letter-spacing: 0.05em;
      text-align: center;
      animation: balrogPulse 0.4s ease-in-out infinite alternate;
    }
    @keyframes balrogPulse {
      0%   { transform: scale(1); }
      100% { transform: scale(1.04); }
    }
    .balrog-sub {
      font-family: 'IM Fell English', Georgia, serif;
      font-style: italic;
      font-size: clamp(0.9rem, 2.5vw, 1.3rem);
      color: rgba(255,180,50,0.9);
      margin-top: 1.5rem;
      text-align: center;
      text-shadow: 0 0 15px rgba(255,120,0,0.8);
    }
    .balrog-flame {
      font-size: 4rem;
      margin-top: 2rem;
      animation: balrogPulse 0.3s ease-in-out infinite alternate;
      filter: drop-shadow(0 0 15px rgba(255,100,0,0.9));
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       EASTER EGG â€” STAR OF DURIN PARTICLES
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #star-particle-canvas {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 500;
      display: none;
    }
    #ring-inscription {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 501;
      pointer-events: none;
      flex-direction: column;
      gap: 1rem;
    }
    #ring-inscription.show {
      display: flex;
    }
    .ring-text-line {
      font-family: 'IM Fell English', Georgia, serif;
      font-style: italic;
      font-size: clamp(1rem, 3vw, 1.6rem);
      color: var(--gold-glow);
      text-shadow:
        0 0 15px rgba(240,192,96,0.9),
        0 0 40px rgba(240,192,96,0.5);
      text-align: center;
      letter-spacing: 0.08em;
      animation: ringTextFade 0.6s ease forwards;
      opacity: 0;
    }
    .ring-text-line:nth-child(1) { animation-delay: 0.3s; }
    .ring-text-line:nth-child(2) { animation-delay: 0.7s; }
    .ring-text-line:nth-child(3) { animation-delay: 1.1s; }
    .ring-text-line:nth-child(4) { animation-delay: 1.5s; }
    @keyframes ringTextFade {
      0%   { opacity: 0; transform: translateY(8px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    .ring-inscription-ring {
      font-size: 4rem;
      color: var(--gold);
      text-shadow: 0 0 20px rgba(240,192,96,0.8), 0 0 60px rgba(240,192,96,0.4);
      animation: ringRotate 8s linear infinite;
      display: inline-block;
      opacity: 0;
      animation-delay: 0.1s;
      animation-fill-mode: both;
    }
    @keyframes ringRotate {
      0%   { transform: rotate(0deg) scale(1); opacity: 0; }
      10%  { opacity: 1; }
      90%  { opacity: 1; }
      100% { transform: rotate(360deg) scale(1.1); opacity: 0; }
    }

    /* Door shimmer â€” type "mellon" */
    @keyframes doorShimmer {
      0%   { filter: drop-shadow(0 0 40px rgba(100,160,255,0.12)); }
      25%  { filter: drop-shadow(0 0 80px rgba(201,168,76,0.6)) drop-shadow(0 0 30px rgba(107,197,255,0.4)); }
      50%  { filter: drop-shadow(0 0 100px rgba(201,168,76,0.8)) drop-shadow(0 0 40px rgba(255,220,100,0.5)); }
      75%  { filter: drop-shadow(0 0 80px rgba(201,168,76,0.5)) drop-shadow(0 0 25px rgba(107,197,255,0.3)); }
      100% { filter: drop-shadow(0 0 40px rgba(100,160,255,0.12)); }
    }
    .door-shimmer {
      animation: doorShimmer 2.5s ease-in-out !important;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       EASTER EGG â€” HIDDEN ONE RING
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #hidden-ring {
      position: fixed;
      bottom: 18px;
      right: 22px;
      font-size: 0.85rem;
      color: rgba(100,80,20,0.12);
      cursor: default;
      transition: all 0.5s ease;
      z-index: 50;
      user-select: none;
      line-height: 1;
    }
    #hidden-ring:hover {
      color: var(--gold-glow);
      text-shadow:
        0 0 8px rgba(240,192,96,0.9),
        0 0 20px rgba(240,192,96,0.6),
        0 0 40px rgba(240,192,96,0.3);
      font-size: 1.8rem;
      bottom: 14px;
      right: 16px;
    }
    #hidden-ring .ring-tooltip {
      position: absolute;
      bottom: calc(100% + 8px);
      right: 0;
      background: rgba(10,14,26,0.95);
      border: 1px solid var(--gold-dim);
      border-radius: 4px;
      padding: 0.35rem 0.7rem;
      font-family: 'IM Fell English', Georgia, serif;
      font-style: italic;
      font-size: 0.82rem;
      color: var(--gold);
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease 0.3s;
      box-shadow: 0 0 12px rgba(201,168,76,0.3);
    }
    #hidden-ring:hover .ring-tooltip {
      opacity: 1;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       EASTER EGG â€” SHIRE REFERENCE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #shire-leaf {
      position: fixed;
      top: 22px;
      left: 20px;
      font-size: 0.75rem;
      color: rgba(60,90,50,0.10);
      cursor: default;
      z-index: 50;
      user-select: none;
      transition: color 0.5s ease;
    }
    #shire-leaf:hover {
      color: rgba(80,160,70,0.7);
    }
    #shire-quote {
      position: fixed;
      top: 40px;
      left: 12px;
      background: rgba(8,12,20,0.95);
      border: 1px solid rgba(60,90,40,0.4);
      border-radius: 6px;
      padding: 0.8rem 1.2rem;
      max-width: 240px;
      font-family: 'IM Fell English', Georgia, serif;
      font-style: italic;
      font-size: 0.82rem;
      color: rgba(160,200,120,0.9);
      text-shadow: 0 0 8px rgba(80,160,50,0.4);
      line-height: 1.7;
      pointer-events: none;
      opacity: 0;
      transform: translateY(-4px);
      transition: all 0.5s ease;
      z-index: 51;
    }
    #shire-leaf:hover ~ #shire-quote,
    #shire-quote.show {
      opacity: 1;
      transform: translateY(0);
    }
    .leaf-particle {
      position: fixed;
      pointer-events: none;
      font-size: 0.7rem;
      z-index: 52;
      animation: leafFloat 3s ease-out forwards;
      opacity: 0;
    }
    @keyframes leafFloat {
      0%   { opacity: 0; transform: translateY(0) rotate(0deg); }
      20%  { opacity: 0.8; }
      100% { opacity: 0; transform: translateY(-120px) rotate(180deg) translateX(30px); }
    }

    /* Star glow levels (applied via CSS var) */
    #star-outer {
      --star-glow-level: 1;
    }
    .star-of-durin {
      filter: drop-shadow(0 0 calc(3px * var(--star-glow-level)) rgba(184,212,240,0.7));
      cursor: pointer;
      transition: filter 0.3s ease;
    }
    .star-of-durin:hover {
      filter: drop-shadow(0 0 calc(5px * var(--star-glow-level) + 2px) rgba(184,212,240,0.9));
    }
  </style>
</head>
<body>

  <!-- â•â• EASTER EGG OVERLAYS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

  <!-- Balrog overlay (Konami code) -->
  <div id="balrog-overlay" role="dialog" aria-hidden="true">
    <div class="balrog-text">YOU SHALL NOT PASS</div>
    <div class="balrog-sub">â€” Gandalf the Grey, Bridge of Khazad-dÃ»m</div>
    <div class="balrog-flame">ğŸ”¥</div>
  </div>

  <!-- Star particle canvas -->
  <canvas id="star-particle-canvas"></canvas>

  <!-- Ring inscription (star 7th click) -->
  <div id="ring-inscription" aria-hidden="true">
    <span class="ring-inscription-ring">â—¯</span>
    <p class="ring-text-line">One Ring to rule them all,</p>
    <p class="ring-text-line">One Ring to find them,</p>
    <p class="ring-text-line">One Ring to bring them all</p>
    <p class="ring-text-line">and in the darkness bind them.</p>
  </div>

  <!-- Mellon portal message -->
  <div id="mellon-message" aria-hidden="true">
    <p class="mellon-msg-text">
      The way is shutâ€¦<br>
      <em>just kidding.</em><br>
      Welcome, friend. âœ¦
    </p>
    <span class="gandalf-silhouette" title="Gandalf">ğŸ§™</span>
  </div>

  <!-- Hidden One Ring (bottom right corner) -->
  <div id="hidden-ring" aria-hidden="true">
    â—¯
    <span class="ring-tooltip">My preciousâ€¦</span>
  </div>

  <!-- Hidden Shire reference (top left corner) -->
  <div id="shire-leaf" aria-hidden="true">â§</div>
  <div id="shire-quote" aria-hidden="true">
    Not all those who wander are lost.<br>
    <span style="font-size:0.72rem; opacity:0.6; font-style:normal; display:block; margin-top:0.4rem;">â€” J.R.R. Tolkien</span>
  </div>

  <!-- Twinkling star field -->
  <canvas id="stars-canvas"></canvas>

  <!-- Mountain silhouette -->
  <svg class="mountain-silhouette" viewBox="0 0 1400 130" preserveAspectRatio="none"
       xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <defs>
      <linearGradient id="mountFade" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#0a0e1a" stop-opacity="0"/>
        <stop offset="55%" stop-color="#080c16" stop-opacity="0.7"/>
        <stop offset="100%" stop-color="#050810" stop-opacity="1"/>
      </linearGradient>
    </defs>
    <path d="M0 130 L0 90 L60 55 L110 75 L170 32 L230 62 L290 20 L360 58
             L430 35 L500 70 L570 15 L640 55 L700 30 L760 65 L830 10
             L890 50 L950 25 L1020 60 L1080 38 L1140 70 L1200 22 L1260 55
             L1320 40 L1380 68 L1400 50 L1400 130 Z"
          fill="#07090f"/>
    <path d="M170 32 L185 45 L155 45 Z M290 20 L305 36 L275 36 Z M570 15 L586 32 L554 32 Z
             M700 30 L714 44 L686 44 Z M830 10 L847 28 L813 28 Z M950 25 L965 40 L935 40 Z
             M1200 22 L1215 37 L1185 37 Z"
          fill="#1a2540" opacity="0.5"/>
    <rect x="0" y="0" width="1400" height="130" fill="url(#mountFade)"/>
  </svg>

  <!-- Mist -->
  <div class="mist-layer"></div>

  <!-- Page -->
  <div class="page-wrapper">

    <!-- â•â• The Door â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="door-container fade-in-up" id="doorWrap">
      <svg class="door-svg" viewBox="0 0 400 520"
           xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Durin's Door arch"
           id="door-svg">
        <defs>
          <filter id="glow-elvish" x="-100%" y="-100%" width="300%" height="300%">
            <feGaussianBlur stdDeviation="3.5" result="b"/>
            <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
          <filter id="glow-silver" x="-80%" y="-80%" width="260%" height="260%">
            <feGaussianBlur stdDeviation="2.5" result="b"/>
            <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
          <filter id="glow-gold" x="-100%" y="-100%" width="300%" height="300%">
            <feGaussianBlur stdDeviation="5" result="b"/>
            <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
          <filter id="glow-crack" x="-200%" y="-50%" width="500%" height="200%">
            <feGaussianBlur stdDeviation="4" result="b"/>
            <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
          <filter id="glow-portal" x="-100%" y="-100%" width="300%" height="300%">
            <feGaussianBlur stdDeviation="8" result="b"/>
            <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>

          <radialGradient id="voidGrad" cx="50%" cy="25%" r="70%">
            <stop offset="0%" stop-color="#0c1424"/>
            <stop offset="60%" stop-color="#060910"/>
            <stop offset="100%" stop-color="#020408"/>
          </radialGradient>
          <radialGradient id="portalGrad" cx="50%" cy="35%" r="65%">
            <stop offset="0%" stop-color="#a0d8ff" stop-opacity="0.85"/>
            <stop offset="30%" stop-color="#4090d0" stop-opacity="0.55"/>
            <stop offset="65%" stop-color="#1a3a6a" stop-opacity="0.25"/>
            <stop offset="100%" stop-color="#020408" stop-opacity="0"/>
          </radialGradient>
          <radialGradient id="crackGrad" cx="50%" cy="100%" r="60%">
            <stop offset="0%" stop-color="rgba(107,197,255,0.45)"/>
            <stop offset="100%" stop-color="rgba(107,197,255,0)"/>
          </radialGradient>

          <pattern id="stoneTex" x="0" y="0" width="60" height="44" patternUnits="userSpaceOnUse">
            <rect width="60" height="44" fill="#0d1525"/>
            <line x1="0" y1="0"  x2="60" y2="0"  stroke="#111e34" stroke-width="0.7"/>
            <line x1="0" y1="22" x2="60" y2="22" stroke="#111e34" stroke-width="0.7"/>
            <line x1="30" y1="0" x2="30" y2="22" stroke="#111e34" stroke-width="0.4"/>
            <line x1="0"  y1="22" x2="0"  y2="44" stroke="#111e34" stroke-width="0.4"/>
            <line x1="60" y1="22" x2="60" y2="44" stroke="#111e34" stroke-width="0.4"/>
          </pattern>

          <clipPath id="archClip">
            <rect x="0" y="0" width="400" height="520"/>
          </clipPath>
          <clipPath id="archVoidClip">
            <path d="M 88 512 L 88 308 Q 86 105 200 68 Q 314 105 312 308 L 312 512 Z"/>
          </clipPath>
        </defs>

        <!-- â”€â”€ Stone wall â”€â”€ -->
        <path fill="url(#stoneTex)" stroke="#1a2844" stroke-width="0.6"
              fill-rule="evenodd"
              d="M 0 0 L 400 0 L 400 520 L 0 520 Z
                 M 88 512 L 88 308 Q 86 105 200 68 Q 314 105 312 308 L 312 512 Z"/>

        <!-- â”€â”€ Door void â”€â”€ -->
        <path fill="url(#voidGrad)"
              d="M 88 512 L 88 308 Q 86 105 200 68 Q 314 105 312 308 L 312 512 Z"/>

        <!-- â”€â”€ Portal glow (hidden until Mellon) â”€â”€ -->
        <path id="portal-fill" fill="url(#portalGrad)" opacity="0"
              d="M 88 512 L 88 308 Q 86 105 200 68 Q 314 105 312 308 L 312 512 Z">
          <animate id="portal-anim" attributeName="opacity" values="0;0" dur="0.1s" repeatCount="1" fill="freeze"/>
        </path>

        <!-- Portal sparkle stars (inside arch) -->
        <g id="portal-sparkles" clip-path="url(#archVoidClip)" opacity="0">
          <circle cx="145" cy="180" r="1.5" fill="white" opacity="0.9">
            <animate attributeName="opacity" values="0.2;1;0.2" dur="1.3s" repeatCount="indefinite" begin="0.1s"/>
          </circle>
          <circle cx="200" cy="140" r="2" fill="white" opacity="0.7">
            <animate attributeName="opacity" values="0.1;0.9;0.1" dur="1.8s" repeatCount="indefinite" begin="0.5s"/>
          </circle>
          <circle cx="255" cy="195" r="1.2" fill="white" opacity="0.8">
            <animate attributeName="opacity" values="0.3;1;0.3" dur="1.1s" repeatCount="indefinite" begin="0.3s"/>
          </circle>
          <circle cx="170" cy="230" r="1.8" fill="#b0e0ff" opacity="0.6">
            <animate attributeName="opacity" values="0.1;0.8;0.1" dur="2.1s" repeatCount="indefinite" begin="0.7s"/>
          </circle>
          <circle cx="230" cy="250" r="1.3" fill="#e0f4ff" opacity="0.7">
            <animate attributeName="opacity" values="0.2;1;0.2" dur="1.6s" repeatCount="indefinite" begin="0.2s"/>
          </circle>
          <circle cx="200" cy="300" r="1.5" fill="white" opacity="0.5">
            <animate attributeName="opacity" values="0.1;0.7;0.1" dur="1.4s" repeatCount="indefinite" begin="0.9s"/>
          </circle>
          <circle cx="155" cy="310" r="1.0" fill="#c0e8ff" opacity="0.6">
            <animate attributeName="opacity" values="0.3;0.9;0.3" dur="1.9s" repeatCount="indefinite" begin="0.4s"/>
          </circle>
          <circle cx="245" cy="170" r="1.4" fill="white" opacity="0.8">
            <animate attributeName="opacity" values="0.2;1;0.2" dur="1.2s" repeatCount="indefinite" begin="0.6s"/>
          </circle>
        </g>

        <!-- Base crack glow -->
        <ellipse cx="200" cy="512" rx="90" ry="16" fill="url(#crackGrad)">
          <animate attributeName="opacity" values="0.5;1.0;0.5" dur="3.2s" repeatCount="indefinite"/>
        </ellipse>

        <!-- â”€â”€ Arch outlines â”€â”€ -->
        <path fill="none" stroke="#2e4268" stroke-width="1.2" opacity="0.45"
              d="M 65 512 L 65 305 Q 62 90 200 48 Q 338 90 335 305 L 335 512"/>
        <path class="arch-outer"
              d="M 88 512 L 88 308 Q 86 105 200 68 Q 314 105 312 308 L 312 512"/>
        <path class="arch-inner" id="arch-inner-glow"
              d="M 106 512 L 106 312 Q 106 122 200 87 Q 294 122 294 312 L 294 512"/>
        <path fill="none" stroke="rgba(120,160,220,0.12)" stroke-width="4"
              d="M 88 310 Q 86 108 200 68 Q 314 108 312 310"/>

        <!-- â”€â”€ Rune inscription band â”€â”€ -->
        <path fill="rgba(42,58,92,0.25)" stroke="rgba(42,58,92,0.4)" stroke-width="0.5"
              d="M 65 305 Q 62 90 200 48 Q 338 90 335 305 L 345 305 Q 345 80 200 36 Q 55 80 55 305 Z"/>
        <text class="rune-text" x="200" y="52" text-anchor="middle"
              font-size="12" letter-spacing="5">á›—á›–á›šá›šá›Ÿáš¾ Â· áš áš±á›–á›Ÿáš¾á› Â· á›–áš¾á›á›–áš±</text>

        <!-- Rune spin ring -->
        <g class="rune-spin" clip-path="url(#archClip)">
          <circle cx="200" cy="200" r="148"
                  fill="none" stroke="rgba(107,197,255,0.06)" stroke-width="0.8"
                  stroke-dasharray="4 8"/>
        </g>

        <!-- â”€â”€ Star of Durin â”€â”€ -->
        <g id="star-outer" filter="url(#glow-silver)" style="--star-glow-level:1">
          <g class="star-of-durin" id="star-of-durin-g" transform="translate(200,196)"
             style="cursor:pointer" role="button" aria-label="Star of Durin">
            <line x1="0" y1="-46" x2="0"   y2="46"  stroke-width="1.5"/>
            <line x1="-46" y1="0" x2="46"  y2="0"   stroke-width="1.5"/>
            <line x1="-33" y1="-33" x2="33" y2="33" stroke-width="1.4"/>
            <line x1="33"  y1="-33" x2="-33" y2="33" stroke-width="1.4"/>
            <polygon points="0,-54 38,-38 54,0 38,38 0,54 -38,38 -54,0 -38,-38"
                     fill="none" stroke="var(--silver)" stroke-width="0.7" opacity="0.45"/>
            <circle r="30" fill="none" stroke="var(--silver)" stroke-width="0.5" opacity="0.3"/>
            <circle r="10" fill="none" stroke-width="1.2"/>
            <circle r="4" fill="var(--silver-glow)" stroke="none"/>
            <!-- Invisible larger hit area -->
            <circle r="60" fill="transparent" stroke="none"/>
          </g>
        </g>

        <!-- â”€â”€ Elvish tree â”€â”€ -->
        <g filter="url(#glow-elvish)" opacity="0.80">
          <line x1="200" y1="278" x2="200" y2="335" stroke="var(--elvish)" stroke-width="1.6"/>
          <line x1="200" y1="335" x2="182" y2="346" stroke="var(--elvish)" stroke-width="1"/>
          <line x1="200" y1="335" x2="218" y2="346" stroke="var(--elvish)" stroke-width="1"/>
          <line x1="200" y1="325" x2="176" y2="312" stroke="var(--elvish)" stroke-width="1.0"/>
          <line x1="200" y1="313" x2="170" y2="296" stroke="var(--elvish)" stroke-width="0.8"/>
          <line x1="200" y1="303" x2="178" y2="284" stroke="var(--elvish)" stroke-width="0.7"/>
          <line x1="200" y1="325" x2="224" y2="312" stroke="var(--elvish)" stroke-width="1.0"/>
          <line x1="200" y1="313" x2="230" y2="296" stroke="var(--elvish)" stroke-width="0.8"/>
          <line x1="200" y1="303" x2="222" y2="284" stroke="var(--elvish)" stroke-width="0.7"/>
          <circle cx="174" cy="310" r="2.8" fill="var(--elvish)" opacity="0.75"/>
          <circle cx="168" cy="293" r="2.2" fill="var(--elvish)" opacity="0.65"/>
          <circle cx="176" cy="281" r="2.0" fill="var(--elvish)" opacity="0.60"/>
          <circle cx="226" cy="310" r="2.8" fill="var(--elvish)" opacity="0.75"/>
          <circle cx="232" cy="293" r="2.2" fill="var(--elvish)" opacity="0.65"/>
          <circle cx="224" cy="281" r="2.0" fill="var(--elvish)" opacity="0.60"/>
          <circle cx="200" cy="255" r="2.5" fill="var(--elvish)" opacity="0.55"/>
          <circle cx="200" cy="278" r="1.5" fill="var(--elvish)" opacity="0.45"/>
        </g>

        <!-- â”€â”€ Pillar rune strips â”€â”€ -->
        <rect fill="rgba(30,44,72,0.35)" stroke="rgba(42,58,92,0.3)" stroke-width="0.5"
              x="65" y="112" width="23" height="195" rx="2"/>
        <rect fill="rgba(30,44,72,0.35)" stroke="rgba(42,58,92,0.3)" stroke-width="0.5"
              x="312" y="112" width="23" height="195" rx="2"/>

        <!-- Left pillar runes â€” id="rune-L0" through "rune-L7" -->
        <text class="rune-text" id="rune-L0" x="76.5" y="140" text-anchor="middle" font-size="11" style="animation-delay:0.1s">áš </text>
        <text class="rune-text" id="rune-L1" x="76.5" y="161" text-anchor="middle" font-size="11" style="animation-delay:0.5s">áš¢</text>
        <text class="rune-text" id="rune-L2" x="76.5" y="182" text-anchor="middle" font-size="11" style="animation-delay:0.9s">áš±</text>
        <text class="rune-text" id="rune-L3" x="76.5" y="203" text-anchor="middle" font-size="11" style="animation-delay:1.3s">áš¨</text>
        <text class="rune-text" id="rune-L4" x="76.5" y="224" text-anchor="middle" font-size="11" style="animation-delay:1.7s">á›Š</text>
        <text class="rune-text" id="rune-L5" x="76.5" y="245" text-anchor="middle" font-size="11" style="animation-delay:2.1s">á›</text>
        <text class="rune-text" id="rune-L6" x="76.5" y="266" text-anchor="middle" font-size="11" style="animation-delay:2.5s">á›</text>
        <text class="rune-text" id="rune-L7" x="76.5" y="287" text-anchor="middle" font-size="11" style="animation-delay:2.9s">á›œ</text>

        <!-- Left pillar hit areas (transparent rects for better hover) -->
        <rect id="rune-hit-L0" x="58" y="126" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-L1" x="58" y="147" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-L2" x="58" y="168" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-L3" x="58" y="189" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-L4" x="58" y="210" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-L5" x="58" y="231" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-L6" x="58" y="252" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-L7" x="58" y="273" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>

        <!-- Right pillar runes â€” id="rune-R0" through "rune-R7" -->
        <text class="rune-text" id="rune-R0" x="323.5" y="140" text-anchor="middle" font-size="11" style="animation-delay:0.3s">á›</text>
        <text class="rune-text" id="rune-R1" x="323.5" y="161" text-anchor="middle" font-size="11" style="animation-delay:0.7s">áš¢</text>
        <text class="rune-text" id="rune-R2" x="323.5" y="182" text-anchor="middle" font-size="11" style="animation-delay:1.1s">áš±</text>
        <text class="rune-text" id="rune-R3" x="323.5" y="203" text-anchor="middle" font-size="11" style="animation-delay:1.5s">á›</text>
        <text class="rune-text" id="rune-R4" x="323.5" y="224" text-anchor="middle" font-size="11" style="animation-delay:1.9s">áš¾</text>
        <text class="rune-text" id="rune-R5" x="323.5" y="245" text-anchor="middle" font-size="11" style="animation-delay:2.3s">á›Š</text>
        <text class="rune-text" id="rune-R6" x="323.5" y="266" text-anchor="middle" font-size="11" style="animation-delay:2.7s">á›Ÿ</text>
        <text class="rune-text" id="rune-R7" x="323.5" y="287" text-anchor="middle" font-size="11" style="animation-delay:3.1s">á›—</text>

        <!-- Right pillar hit areas -->
        <rect id="rune-hit-R0" x="305" y="126" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-R1" x="305" y="147" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-R2" x="305" y="168" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-R3" x="305" y="189" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-R4" x="305" y="210" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-R5" x="305" y="231" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-R6" x="305" y="252" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>
        <rect id="rune-hit-R7" x="305" y="273" width="37" height="20" fill="transparent" stroke="none" style="cursor:default"/>

        <!-- Animated rune lines on pillars -->
        <line class="rune-line" x1="76.5" y1="305" x2="76.5" y2="118" style="animation-delay:0.2s"/>
        <line class="rune-line" x1="323.5" y1="305" x2="323.5" y2="118" style="animation-delay:0.7s"/>

        <!-- â”€â”€ Central door crack â”€â”€ -->
        <line x1="200" y1="90" x2="200" y2="512"
              stroke="var(--elvish)" stroke-width="0.6" filter="url(#glow-crack)">
          <animate attributeName="opacity" values="0.10;0.38;0.10" dur="4.5s" repeatCount="indefinite"/>
        </line>

        <!-- Crown jewel -->
        <circle cx="200" cy="68" r="5" fill="none"
                stroke="var(--gold)" stroke-width="1.2"
                filter="url(#glow-gold)" opacity="0.8"/>
        <circle cx="200" cy="68" r="9" fill="none"
                stroke="var(--gold-dim)" stroke-width="0.5" opacity="0.45"/>
        <circle cx="200" cy="68" r="2.5" fill="var(--gold)" filter="url(#glow-gold)" opacity="0.9"/>

        <!-- Stone threshold -->
        <rect x="55" y="508" width="290" height="9" rx="2"
              fill="#0d1525" stroke="#1e2d48" stroke-width="0.8"/>
        <line x1="55" y1="512" x2="345" y2="512"
              stroke="#2a3a5c" stroke-width="0.6" opacity="0.5"/>

        <!-- Corner knot work -->
        <circle cx="86" cy="110" r="8" fill="none"
                stroke="rgba(107,197,255,0.18)" stroke-width="0.8"/>
        <circle cx="314" cy="110" r="8" fill="none"
                stroke="rgba(107,197,255,0.18)" stroke-width="0.8"/>

      </svg>
      <div class="door-glow" id="doorGlow"></div>
    </div>
    <!-- /.door-container -->

    <!-- Title -->
    <h1 class="site-title fade-in-up fade-in-up-delay-1">Durin's Door</h1>

    <!-- Elvish subtitle -->
    <p class="site-subtitle fade-in-up fade-in-up-delay-2">
      Encrypted. Temporary. Forgotten when the time comes.
    </p>

    <!-- Speak friend inscription -->
    <p class="speak-friend fade-in-up fade-in-up-delay-2">
      âœ¦ &thinsp; Speak, friend, and enter â€” then download. &thinsp; âœ¦
    </p>

    <!-- Stone tablets with stats -->
    <div class="stone-tablets fade-in-up fade-in-up-delay-3">
      <div class="stone-tablet">
        <span class="tablet-value">{{.ActiveShares}}</span>
        <span class="tablet-label">Open Portals</span>
      </div>
      <div class="stone-tablet">
        <span class="tablet-value" style="font-size:1.4rem; letter-spacing:-0.03em">AES</span>
        <span class="tablet-label">256&#8209;GCM</span>
      </div>
      <div class="stone-tablet">
        <span class="tablet-value" style="font-size:1.6rem">â³</span>
        <span class="tablet-label">Self&#8209;Destruct</span>
      </div>
    </div>

    <!-- Usage hint -->
    <div class="fade-in-up fade-in-up-delay-4" style="text-align:center; margin-top:2rem;">
      <p style="margin-bottom:0.7rem;">
        <code class="cmd-hint">durins-door share myfile.zip</code>
      </p>
      <p class="flavor-text">
        Files encrypted before they touch the disk.<br>
        Links expire. The door closes. None shall pass.<br>
        No accounts. No logs. Only the Word of a friend.
      </p>
    </div>

    <!-- â”€â”€ Hall Navigation â”€â”€ -->
    <nav class="hall-nav fade-in-up fade-in-up-delay-4" aria-label="Site navigation">
      <a href="/gallery" class="hall-link">
        <span class="hall-link-rune">áš </span>Enter the Halls
      </a>
      <a href="/guide" class="hall-link">
        <span class="hall-link-rune">áš¢</span>The Lore-Book
      </a>
    </nav>

  </div><!-- /.page-wrapper -->

  <script>
  /* â”€â”€ Star field â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  (function () {
    const cv = document.getElementById('stars-canvas');
    const cx = cv.getContext('2d');
    let W, H, stars = [], frame = 0;

    function resize() {
      W = cv.width  = window.innerWidth;
      H = cv.height = window.innerHeight;
      initStars();
    }

    function initStars() {
      stars = [];
      const N = Math.min(Math.floor(W * H / 4200) + 60, 320);
      for (let i = 0; i < N; i++) {
        stars.push({
          x:     Math.random() * W,
          y:     Math.random() * H * 0.74,
          r:     Math.random() * 1.45 + 0.18,
          phase: Math.random() * Math.PI * 2,
          speed: 0.003 + Math.random() * 0.018,
          blue:  Math.random() < 0.22,
        });
      }
    }

    function draw() {
      cx.clearRect(0, 0, W, H);
      frame++;
      for (const s of stars) {
        const lum = 0.30 + 0.70 * (0.5 + 0.5 * Math.sin(s.phase + frame * s.speed));
        cx.fillStyle = s.blue
          ? `rgba(155,215,255,${lum})`
          : `rgba(218,208,186,${lum * 0.88})`;
        cx.beginPath();
        cx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
        cx.fill();
      }
      requestAnimationFrame(draw);
    }

    window.addEventListener('resize', resize, { passive: true });
    resize();
    draw();
  })();

  /* â”€â”€ Door hover glow â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  (function () {
    const wrap = document.getElementById('doorWrap');
    if (!wrap) return;
    wrap.addEventListener('mouseenter', () => wrap.classList.add('active'));
    wrap.addEventListener('mouseleave', () => wrap.classList.remove('active'));
  })();

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     EASTER EGG 1 â€” Mellon Hover Sequence
     Hover L0â†’L7 then R0â†’R7 to open the door
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  (function () {
    const SEQUENCE = [
      'rune-hit-L0','rune-hit-L1','rune-hit-L2','rune-hit-L3',
      'rune-hit-L4','rune-hit-L5','rune-hit-L6','rune-hit-L7',
      'rune-hit-R0','rune-hit-R1','rune-hit-R2','rune-hit-R3',
      'rune-hit-R4','rune-hit-R5','rune-hit-R6','rune-hit-R7',
    ];
    let step = 0;
    let resetTimer = null;

    // Also highlight the corresponding text rune
    function highlightRune(hitId, on) {
      const textId = hitId.replace('rune-hit-', 'rune-');
      const el = document.getElementById(textId);
      if (!el) return;
      if (on) {
        el.style.fill = '#a0dfff';
        el.style.filter = 'url(#glow-portal)';
      } else {
        el.style.fill = '';
        el.style.filter = '';
      }
    }

    SEQUENCE.forEach((id, idx) => {
      const el = document.getElementById(id);
      if (!el) return;

      el.addEventListener('mouseenter', () => {
        if (idx === step) {
          // Correct next rune!
          highlightRune(id, true);
          step++;
          clearTimeout(resetTimer);

          if (step === SEQUENCE.length) {
            // Sequence complete â€” open the door!
            triggerMellon();
            step = 0;
            setTimeout(() => {
              SEQUENCE.forEach(sid => highlightRune(sid, false));
            }, 5000);
          } else {
            // Reset if user idles for 3 seconds
            resetTimer = setTimeout(() => {
              SEQUENCE.forEach(sid => highlightRune(sid, false));
              step = 0;
            }, 3000);
          }
        } else if (idx !== 0) {
          // Wrong rune â€” reset
          SEQUENCE.forEach(sid => highlightRune(sid, false));
          step = 0;
          clearTimeout(resetTimer);
        }
      });
    });

    function triggerMellon() {
      // Animate portal fill
      const portalFill = document.getElementById('portal-fill');
      const portalSparkles = document.getElementById('portal-sparkles');
      const archInner = document.getElementById('arch-inner-glow');
      const doorWrap = document.getElementById('doorWrap');
      const mellonMsg = document.getElementById('mellon-message');

      if (portalFill) {
        portalFill.style.transition = 'opacity 1.2s ease';
        portalFill.style.opacity = '1';
      }
      if (portalSparkles) {
        portalSparkles.style.transition = 'opacity 0.8s ease 0.4s';
        portalSparkles.style.opacity = '1';
      }
      if (archInner) {
        archInner.style.stroke = 'rgba(160,220,255,0.9)';
        archInner.style.strokeWidth = '2';
        archInner.style.filter = 'url(#glow-portal)';
      }
      if (doorWrap) {
        doorWrap.style.filter = 'drop-shadow(0 0 60px rgba(107,197,255,0.5))';
      }
      if (mellonMsg) {
        mellonMsg.classList.add('show');
      }

      // Close after 6 seconds
      setTimeout(() => {
        if (portalFill) portalFill.style.opacity = '0';
        if (portalSparkles) portalSparkles.style.opacity = '0';
        if (archInner) {
          archInner.style.stroke = '';
          archInner.style.strokeWidth = '';
          archInner.style.filter = '';
        }
        if (doorWrap) doorWrap.style.filter = '';
        if (mellonMsg) mellonMsg.classList.remove('show');
      }, 6000);
    }
  })();

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     EASTER EGG 2 â€” Konami Code â†’ Balrog
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  (function () {
    const KONAMI = [38,38,40,40,37,39,37,39,66,65];
    let pos = 0;
    const overlay = document.getElementById('balrog-overlay');
    if (!overlay) return;

    document.addEventListener('keydown', (e) => {
      if (e.keyCode === KONAMI[pos]) {
        pos++;
        if (pos === KONAMI.length) {
          pos = 0;
          triggerBalrog();
        }
      } else {
        pos = e.keyCode === KONAMI[0] ? 1 : 0;
      }
    });

    function triggerBalrog() {
      overlay.classList.remove('fade-out');
      overlay.classList.add('active');
      overlay.setAttribute('aria-hidden', 'false');

      setTimeout(() => {
        overlay.classList.add('fade-out');
        setTimeout(() => {
          overlay.classList.remove('active', 'fade-out');
          overlay.setAttribute('aria-hidden', 'true');
        }, 1200);
      }, 2800);
    }

    // Also dismiss on click
    overlay.addEventListener('click', () => {
      overlay.classList.add('fade-out');
      setTimeout(() => {
        overlay.classList.remove('active', 'fade-out');
        overlay.setAttribute('aria-hidden', 'true');
      }, 1200);
    });
  })();

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     EASTER EGG 3 â€” Star of Durin: 7 clicks
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  (function () {
    const starGroup = document.getElementById('star-of-durin-g');
    const starOuter = document.getElementById('star-outer');
    const particleCanvas = document.getElementById('star-particle-canvas');
    const ringInscription = document.getElementById('ring-inscription');
    if (!starGroup || !particleCanvas) return;

    let clicks = 0;
    let busy = false;

    starGroup.addEventListener('click', () => {
      if (busy) return;
      clicks++;

      // Increase glow with each click
      const level = Math.min(clicks, 6);
      if (starOuter) {
        starOuter.style.setProperty('--star-glow-level', level);
        // Pulse the filter
        if (starOuter.getAttribute('filter') !== 'url(#glow-gold)' && clicks > 3) {
          starOuter.setAttribute('filter', 'url(#glow-gold)');
        }
      }

      // Flash the star lines brighter
      const lines = starGroup.querySelectorAll('line');
      lines.forEach(l => {
        l.style.stroke = `rgba(${200 + clicks * 8}, ${200 + clicks * 4}, ${240 - clicks * 10}, 1)`;
      });

      if (clicks >= 7) {
        busy = true;
        triggerStarExplosion();
        setTimeout(() => {
          clicks = 0;
          busy = false;
          if (starOuter) {
            starOuter.style.setProperty('--star-glow-level', '1');
            starOuter.setAttribute('filter', 'url(#glow-silver)');
          }
          const lines2 = starGroup.querySelectorAll('line');
          lines2.forEach(l => { l.style.stroke = ''; });
        }, 6000);
      }
    });

    function triggerStarExplosion() {
      // Get star position in viewport
      const svg = document.getElementById('door-svg');
      if (!svg) return;
      const svgRect = svg.getBoundingClientRect();
      const svgW = svgRect.width;
      const svgH = svgRect.height;
      // Star is at SVG coordinate (200, 196), SVG viewBox is 400x520
      const scaleX = svgW / 400;
      const scaleY = svgH / 520;
      const starX = svgRect.left + 200 * scaleX;
      const starY = svgRect.top  + 196 * scaleY;

      // Show canvas
      particleCanvas.style.display = 'block';
      particleCanvas.width = window.innerWidth;
      particleCanvas.height = window.innerHeight;
      const ctx = particleCanvas.getContext('2d');

      // Create particles
      const particles = [];
      const count = 80;
      for (let i = 0; i < count; i++) {
        const angle = (Math.PI * 2 * i) / count + Math.random() * 0.3;
        const speed = 2 + Math.random() * 5;
        const hue = 180 + Math.random() * 60; // blue-ish to silver
        particles.push({
          x: starX, y: starY,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          r: 1 + Math.random() * 2.5,
          life: 1,
          decay: 0.012 + Math.random() * 0.02,
          hue: hue,
        });
      }

      let frame = 0;
      function animParticles() {
        ctx.clearRect(0, 0, particleCanvas.width, particleCanvas.height);
        let alive = false;
        for (const p of particles) {
          if (p.life <= 0) continue;
          alive = true;
          p.x += p.vx;
          p.y += p.vy;
          p.vy += 0.04; // gravity
          p.vx *= 0.98;
          p.life -= p.decay;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r * p.life, 0, Math.PI * 2);
          ctx.fillStyle = `hsla(${p.hue}, 80%, 80%, ${p.life})`;
          ctx.shadowColor = `hsla(${p.hue}, 90%, 90%, ${p.life})`;
          ctx.shadowBlur = 6;
          ctx.fill();
        }
        frame++;
        if (alive && frame < 180) {
          requestAnimationFrame(animParticles);
        } else {
          ctx.clearRect(0, 0, particleCanvas.width, particleCanvas.height);
          particleCanvas.style.display = 'none';
          // Show ring inscription
          if (ringInscription) {
            ringInscription.classList.add('show');
            setTimeout(() => {
              ringInscription.classList.remove('show');
            }, 5000);
          }
        }
      }
      animParticles();
    }
  })();

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     EASTER EGG 4 â€” Type "mellon" anywhere
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  (function () {
    const doorWrap = document.getElementById('doorWrap');
    if (!doorWrap) return;
    let buffer = '';

    document.addEventListener('keypress', (e) => {
      // Don't fire inside inputs
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
      buffer = (buffer + e.key.toLowerCase()).slice(-8);
      if (buffer.includes('mellon')) {
        buffer = '';
        triggerMellonType();
      }
    });

    function triggerMellonType() {
      doorWrap.classList.remove('door-shimmer');
      void doorWrap.offsetWidth; // reflow to restart animation
      doorWrap.classList.add('door-shimmer');
      setTimeout(() => doorWrap.classList.remove('door-shimmer'), 2600);

      // Also briefly show the door crack brighter
      const crack = document.querySelector('#door-svg line[stroke="var(--elvish)"]');
      if (crack) {
        crack.style.opacity = '0.9';
        crack.style.strokeWidth = '2';
        setTimeout(() => {
          crack.style.opacity = '';
          crack.style.strokeWidth = '';
        }, 2500);
      }
    }
  })();

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     EASTER EGG 5 â€” Hidden Ring (handled via CSS)
     The â—¯ in bottom-right corner is pure CSS hover.
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  // No JS needed â€” all CSS.

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     EASTER EGG 6 â€” Shire Leaf Particles
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  (function () {
    const leaf = document.getElementById('shire-leaf');
    if (!leaf) return;
    let leafTimer = null;
    let leafCount = 0;

    leaf.addEventListener('mouseenter', () => {
      if (leafTimer) return;
      spawnLeaves();
      leafTimer = setInterval(spawnLeaves, 800);
    });
    leaf.addEventListener('mouseleave', () => {
      clearInterval(leafTimer);
      leafTimer = null;
    });

    function spawnLeaves() {
      const leafChars = ['ğŸƒ','ğŸŒ¿','ğŸ€','â§','âœ¦'];
      const n = 2 + Math.floor(Math.random() * 2);
      const leafRect = leaf.getBoundingClientRect();
      for (let i = 0; i < n; i++) {
        const el = document.createElement('span');
        el.className = 'leaf-particle';
        el.textContent = leafChars[Math.floor(Math.random() * leafChars.length)];
        el.style.left = (leafRect.left + Math.random() * 30 - 5) + 'px';
        el.style.top  = (leafRect.top  + Math.random() * 10) + 'px';
        el.style.animationDelay = (Math.random() * 0.3) + 's';
        el.style.animationDuration = (2 + Math.random() * 1.5) + 's';
        document.body.appendChild(el);
        setTimeout(() => el.remove(), 4000);
      }
    }
  })();
  </script>
</body>
</html>
